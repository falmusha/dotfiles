#!/bin/bash

git submodule init
git submodule update

SYMLINKS="vimrc zshrc oh-my-zsh vim"
DOTFILES_DIR="$HOME/dotfiles"
BACKUP_SUFFIX="orig"
OHMYZSH_THEME="ifahad7.zsh-theme"

echo "This script makes ZSH your default shell"
# make zsh your default shell
chsh -s /bin/zsh

for SYMLINK in $SYMLINKS; do

  if [ -e "$HOME/.$SYMLINK" ]; then

    i="0"
    while [ -e "$HOME/$SYMLINK.$BACKUP_SUFFIX" ] 
    do
      i=$[$i+1]
      BACKUP_SUFFIX="orig$i"
    done

    echo "Oh ... You have $SYMLINK, I'll back it up for you!!"
    echo -e "Copying symlink $HOME/.$SYMLINK -> $HOME/$SYMLINK.$BACKUP_SUFFIX\n"

    if [ -d $HOME/.$SYMLINK ]; then
      cp -r $HOME/.$SYMLINK $HOME/$SYMLINK.$BACKUP_SUFFIX
    else
      cp $HOME/.$SYMLINK $HOME/$SYMLINK.$BACKUP_SUFFIX
    fi

  fi

  echo "Creating symlinks $HOME/.$SYMLINK -> $DOTFILES_DIR/$SYMLINK"
  ln -s $DOTFILES_DIR/$SYMLINK $HOME/.$SYMLINK


done


# copy vundle
if [ ! -e "$HOME/.vim/bundle/vundle" ]; then
  git clone https://github.com/gmarik/vundle.git $HOME/.vim/bundle/vundle
fi

# install vim plugins
vim +BundleInstall +qal


if [ $DOTFILES_DIR/$OHMYZSH_THEME ]; then
  cp $DOTFILES_DIR/$OHMYZSH_THEME $DOTFILES_DIR/oh-my-zsh/themes/
fi

#run zsh
zsh


